"use strict";(()=>{var e={};e.id=2,e.ids=[2],e.modules={30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},6113:e=>{e.exports=require("crypto")},9523:e=>{e.exports=require("dns")},82361:e=>{e.exports=require("events")},57147:e=>{e.exports=require("fs")},13685:e=>{e.exports=require("http")},85158:e=>{e.exports=require("http2")},41808:e=>{e.exports=require("net")},22037:e=>{e.exports=require("os")},71017:e=>{e.exports=require("path")},77282:e=>{e.exports=require("process")},12781:e=>{e.exports=require("stream")},24404:e=>{e.exports=require("tls")},57310:e=>{e.exports=require("url")},73837:e=>{e.exports=require("util")},59796:e=>{e.exports=require("zlib")},42802:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>h,originalPathname:()=>f,patchFetch:()=>S,requestAsyncStorage:()=>E,routeModule:()=>g,serverHooks:()=>A,staticGenerationAsyncStorage:()=>I,staticGenerationBailout:()=>v});var s={};r.r(s),r.d(s,{POST:()=>d});var a=r(95419),n=r(69108),i=r(99678),o=r(78070),u=r(37235),p=r(47506),c=r(51127),l=r(43160);async function d(e){try{let{name:t,email:r,phone:s,password:a}=await e.json();if(!t||!r||!s||!a)return o.Z.json({message:"Vui l\xf2ng điền đầy đủ th\xf4ng tin"},{status:400});if(a.length<6)return o.Z.json({message:"Mật khẩu phải c\xf3 \xedt nhất 6 k\xfd tự"},{status:400});let n=(await (0,u.Xb)(p.I,r,a)).user;await c.CZ.updateUser(n.uid,{displayName:t});let i=await (0,l.a7)(n.uid,{name:t,email:r,phone:s,role:"CUSTOMER",points:0});return o.Z.json({message:"Đăng k\xfd th\xe0nh c\xf4ng!",user:i},{status:201})}catch(e){if(console.error("Registration error:",e),"auth/email-already-in-use"===e.code)return o.Z.json({message:"Email n\xe0y đ\xe3 được sử dụng"},{status:400});if("auth/weak-password"===e.code)return o.Z.json({message:"Mật khẩu qu\xe1 yếu"},{status:400});if("auth/invalid-email"===e.code)return o.Z.json({message:"Email kh\xf4ng hợp lệ"},{status:400});return o.Z.json({message:"Đ\xe3 xảy ra lỗi, vui l\xf2ng thử lại"},{status:500})}}let g=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/register/route",pathname:"/api/auth/register",filename:"route",bundlePath:"app/api/auth/register/route"},resolvedPagePath:"/Users/tuannguyen/Applications/Mbread/app/api/auth/register/route.ts",nextConfigOutput:"",userland:s}),{requestAsyncStorage:E,staticGenerationAsyncStorage:I,serverHooks:A,headerHooks:h,staticGenerationBailout:v}=g,f="/api/auth/register/route";function S(){return(0,i.patchFetch)({serverHooks:A,staticGenerationAsyncStorage:I})}},51127:(e,t,r)=>{r.d(t,{CZ:()=>u,iW:()=>p});let s=require("firebase-admin/app"),a=require("firebase-admin/auth"),n=require("firebase-admin/firestore"),i={credential:(0,s.cert)({projectId:process.env.FIREBASE_ADMIN_PROJECT_ID||"mbreadcoffeetea-75636",privateKey:process.env.FIREBASE_ADMIN_PRIVATE_KEY||"-----BEGIN PRIVATE KEY-----\nMIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQDKt82ell6OZ2C3\n+Ry5ik9xoRwQUIAXNRbvFPFokHbcK0Zio+5YjUB8CS1kFx/yQbfzlo9mEr5tWDhY\nQXvXHjwxSu6kEpUOIGANB6qs/FPLh30EkAOsRCl5Urg58k08lgICCjeRUMgCd6vF\nFzgPiXSvp2Zc66DZuaQ4VA6Q85JuvKL5WC8M5PuzxvrJfBLVXpWBen6/inTabWdR\n0JIXU7WFuQ4kL+Ji35t90FAjh2XY8AESTWbwXguXv9lHXjf+numzvDc2vWVq4acV\nKVbpnoKgzvP8tT/3CG+qrF3l8a932rnsrCZwoMCTKoZis24+SMoPFCsRSQoB9YwV\nl175DdaDAgMBAAECggEASCeaMat2JpvXSkSKG+SGGHzu/0OYBCqqahj7QGvDUuS4\nXd3ZtX05iay+klTE0zbfIf3iNsPPMh5nl8pfKRei9yyjupS+p1OQvLKQ5pe9v8EP\nF7OnCwcL+BogZse/BCSkvFMkqj2lo3MzGakFFEqp1OfxwHtCOp0gPch1ktSPt4gd\nBvyHLpIy2JTN/fGje+5cPfJhniOL4QyfxqPwYPYs0eAYvW3UYroqV2tr6YKGlJub\nJ8nxAK4PNEb+1hUWR0kYn18mkKHIVnXGKuL8QEEKDG68ZIwIeASlanPPKxhtTqTC\nE4fq5VGWBwVEpeqXBsL3a3ma+hDD5hMuD5Z+l/YZ0QKBgQDpL/TH+lm1s7Kpytvw\nnVsBU/HKrZT84JLv0+pE3UDGnPs3N+F6e23WGqywGzqJTD3Z09hrlk6WFBNxrK8R\nAsklLJSEiuQgwBUO0k3FsKhiSb3vfNS8Uc1gYbmt8irjZLYUcqTflx6sy1CuXHPP\nnIKOXvIvvqcSsM0lGT1yHuTfeQKBgQDejMJzOyJagL9E+C03SI3avWxwJ6Gq+n7P\neIDaohgjM57wmPA8jI8uhAKWqTlhhmfQtNkJrXRIPcDZSYpOpvGh+bKL/Sd+f+j0\n6/uLkWxGApOuSA52wstj7fIcHfd0CY0BTq35K5HHIPW7w2aZ8/Y2FhLgQKYBS2U4\nkQmUXxt62wKBgQCgdMdS9AnW5hgCjfxZzW1ZtJGkjVz/xOhW7tM9H6H7CPo0PNeC\nmHwz35cEdzgIUdYdlZBON9dLnfTjO5gbdHdEhTCNI6Vmg8X5tOyfI7g6KdPwf01D\naGaR86z47LJmVl6UI28gC7Sn4h9aW3O1YFTV8q9j+ySrz8zZwkxtwqRqwQKBgQCc\n2R3OstWibWzggfz0Ipl/mdNMNFJXu5YWSPqfnHBglugk79UZB4N+KCHe50N+vYh7\naoowrOPwaj15pr/ocPaJzv8MdI4aNLINtCekFQj3SqekxDoVb3KDalchg+k8CeMs\nEbTBkPh8HHm0LKIqTOuw8Nu62zVkYivjsyzKOkGW0wKBgQDjq5QHhPF/Cs0bfa+h\nZs9GRRrOUIAe1DMRVQV6RxnMX9/TlH4xUIpQsw+6skY5EiAoIPo6+iIX8N5xIYvs\nfMBcvwODDzc9Am9vborYjaMj2uGiUjBD7JA7jV8j+KC4tYCS/jv4RspGWRFp9pDW\nEJMI5I9aSpBUBlsAl8zzGVuEFA==\n-----END PRIVATE KEY-----\n",clientEmail:process.env.FIREBASE_ADMIN_CLIENT_EMAIL||"firebase-adminsdk-fbsvc@mbreadcoffeetea-75636.iam.gserviceaccount.com"}),projectId:process.env.FIREBASE_ADMIN_PROJECT_ID||"mbreadcoffeetea-75636"},o=0===(0,s.getApps)().length?(0,s.initializeApp)(i):(0,s.getApps)()[0],u=(0,a.getAuth)(o),p=(0,n.getFirestore)(o)},43160:(e,t,r)=>{r.d(t,{a7:()=>a,is:()=>n});var s=r(51127);async function a(e,t){let r=new Date().toISOString();await s.CZ.setCustomUserClaims(e,{role:t.role,points:t.points});let a={...t,createdAt:r,updatedAt:r};return await s.iW.collection("users").doc(e).set(a),{id:e,...a}}async function n(e){try{let t=await s.iW.collection("users").doc(e).get();if(!t.exists)return null;let r=t.data();return{id:e,...r}}catch(e){return console.error("Error getting user data:",e),null}}},47506:(e,t,r)=>{r.d(t,{I:()=>u});var s=r(77010),a=r(37235),n=r(4229);let i={apiKey:process.env.FIREBASE_API_KEY||"AIzaSyBr2JEI2uWNjsg_VKedt-cl_JjWaJTnmPc",authDomain:process.env.FIREBASE_AUTH_DOMAIN||"mbreadcoffeetea-75636.firebaseapp.com",projectId:process.env.FIREBASE_PROJECT_ID||"mbreadcoffeetea-75636",storageBucket:process.env.FIREBASE_STORAGE_BUCKET||"mbreadcoffeetea-75636.firebasestorage.app",messagingSenderId:process.env.FIREBASE_MESSAGING_SENDER_ID||"763070371252",appId:process.env.FIREBASE_APP_ID||"1:763070371252:web:91beb9b679724d90c54ee1",measurementId:process.env.FIREBASE_MEASUREMENT_ID||"G-M693P8FDSY"},o=0===(0,s.C6)().length?(0,s.ZF)(i):(0,s.C6)()[0],u=(0,a.v0)(o);(0,n.ad)(o)}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[638,880,70],()=>r(42802));module.exports=s})();