(()=>{var e={};e.id=970,e.ids=[970],e.modules={47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},85833:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>r.a,__next_app__:()=>h,originalPathname:()=>m,pages:()=>o,routeModule:()=>p,tree:()=>d});var a=t(50482),n=t(69108),i=t(62563),r=t.n(i),l=t(68300),c={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>l[e]);t.d(s,c);let d=["",{children:["ordering",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,30053)),"/Users/tuannguyen/Applications/Mbread/app/ordering/page.tsx"]}]},{metadata:{icon:[],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}]},{layout:[()=>Promise.resolve().then(t.bind(t,71152)),"/Users/tuannguyen/Applications/Mbread/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[],apple:[],openGraph:[],twitter:[],manifest:"/manifest.webmanifest"}}],o=["/Users/tuannguyen/Applications/Mbread/app/ordering/page.tsx"],m="/ordering/page",h={require:t,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:n.x.APP_PAGE,page:"/ordering/page",pathname:"/ordering",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},82513:(e,s,t)=>{Promise.resolve().then(t.bind(t,15296))},15296:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>f});var a=t(95344),n=t(3729),i=t(41223),r=t.n(i),l=t(20783),c=t.n(l),d=t(73644),o=t(57916),m=t(38902),h=t(96736),p=t(71224),x=t(93715),g=t(47674),u=t(22254);let y=({cart:e,customerInfo:s,setCustomerInfo:t,orderSummary:n,formatPrice:i,updateQuantity:l,removeFromCart:c,clearCart:d,handleSubmitOrder:o,isSubmitting:h,currentStep:p,nextStep:x,prevStep:g,isMobile:u=!1,handleDetectLocation:y,isDetectingLocation:f,handleAddressChange:j,showAddressSuggestions:b,setShowAddressSuggestions:v,addressSuggestions:N,selectAddress:w,isSearching:k,session:C,router:T,userProfile:S,isLoadingProfile:P,loadUserProfile:A})=>(0,a.jsxs)("div",{className:`bg-white rounded-xl shadow-lg ${u?"p-0":"p-6"} ${u?"":"sticky top-20 max-h-[calc(100vh-6rem)] overflow-y-auto"}`,children:[!u&&(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.Qyq,{className:"text-primary-600 text-xl"}),(0,a.jsxs)("h2",{className:"text-2xl font-serif font-bold text-primary-800",children:["Giỏ h\xe0ng (",e.length,")"]})]}),e.length>0&&a.jsx("button",{onClick:d,className:"text-red-500 hover:text-red-700 text-sm font-medium",children:"X\xf3a tất cả"})]}),0===e.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[a.jsx(m.Qyq,{className:"text-gray-400 text-4xl mx-auto mb-4"}),a.jsx("p",{className:"text-gray-500",children:"Giỏ h\xe0ng trống"}),a.jsx("p",{className:"text-sm text-gray-400 mt-2",children:"Th\xeam m\xf3n ăn để bắt đầu đặt h\xe0ng"}),!C&&a.jsx("div",{className:"mt-4 p-3 bg-blue-50 border border-blue-200 rounded-lg",children:a.jsx("p",{className:"text-sm text-blue-700",children:"\uD83D\uDCA1 Bạn c\xf3 thể đặt m\xf3n m\xe0 kh\xf4ng cần đăng k\xfd t\xe0i khoản"})})]}):(0,a.jsxs)("div",{className:"space-y-4",children:[!C&&(0,a.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-yellow-600"}),a.jsx("span",{className:"text-sm text-yellow-800 font-medium",children:"Đặt m\xf3n kh\xf4ng cần đăng k\xfd"})]}),a.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"Chỉ cần điền th\xf4ng tin li\xean hệ để ho\xe0n tất đơn h\xe0ng"})]}),C&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-green-600"}),(0,a.jsxs)("span",{className:"text-sm text-green-800 font-medium",children:["Ch\xe0o mừng, ",C.user?.name,"!"]})]}),a.jsx("p",{className:"text-xs text-green-700 mt-1",children:"Bạn c\xf3 thể theo d\xf5i đơn h\xe0ng v\xe0 t\xedch lũy điểm thưởng"})]}),a.jsx("div",{className:"space-y-3 overflow-y-auto pr-2",children:e.map(e=>(0,a.jsxs)("div",{className:"flex items-center space-x-3 p-3 bg-gray-50 rounded-lg",children:[a.jsx("div",{className:"relative w-12 h-12 rounded-lg overflow-hidden flex-shrink-0",children:a.jsx(r(),{src:e.image,alt:e.name,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[a.jsx("h4",{className:"font-medium text-primary-800 truncate",children:e.name}),a.jsx("p",{className:"text-sm text-gray-600",children:i(e.price)})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("button",{onClick:()=>l(e.id,e.quantity-1),className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition-colors duration-200",children:a.jsx(m.ego,{size:14})}),a.jsx("span",{className:"w-8 text-center font-medium",children:e.quantity}),a.jsx("button",{onClick:()=>l(e.id,e.quantity+1),className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center hover:bg-gray-300 transition-colors duration-200",children:a.jsx(m.OvN,{size:14})})]}),a.jsx("button",{onClick:()=>c(e.id),className:"text-red-500 hover:text-red-700 transition-colors duration-200 p-1",children:a.jsx(m.Ybf,{size:16})})]},e.id))}),a.jsx("div",{className:"border-t pt-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Tạm t\xednh:"}),a.jsx("span",{children:i(n.subtotal)})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Thuế VAT (10%):"}),a.jsx("span",{children:i(n.tax)})]}),n.deliveryFee>0&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{children:"Ph\xed giao h\xe0ng:"}),a.jsx("span",{children:i(n.deliveryFee)})]}),n.discount>0&&(0,a.jsxs)("div",{className:"flex justify-between text-green-600",children:[a.jsx("span",{children:"Giảm gi\xe1 (5%):"}),(0,a.jsxs)("span",{children:["-",i(n.discount)]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[a.jsx("span",{children:"Tổng cộng:"}),a.jsx("span",{className:"text-primary-600",children:i(n.total)})]})]})}),(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("div",{className:"flex items-center justify-between",children:[1,2,3].map(e=>(0,a.jsxs)("div",{className:"flex items-center",children:[a.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center text-sm font-medium ${e<=p?"bg-primary-600 text-white":"bg-gray-200 text-gray-600"}`,children:e}),e<3&&a.jsx("div",{className:`md:w-24 sm:w-8 w-2 h-0.5 mx-2 ${e<p?"bg-primary-600":"bg-gray-200"}`})]},e))}),1===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("h3",{className:"text-lg font-serif font-semibold text-primary-800",children:"Th\xf4ng tin kh\xe1ch h\xe0ng"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[C&&S&&a.jsx("span",{className:"text-xs bg-green-100 text-green-800 px-2 py-1 rounded-full",children:"Đ\xe3 tự động điền"}),!C&&a.jsx("span",{className:"text-xs bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:"Kh\xe1ch"})]})]}),C&&P&&a.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx("div",{className:"spinner w-4 h-4"}),a.jsx("span",{className:"text-sm text-blue-800",children:"Đang tải th\xf4ng tin từ hồ sơ..."})]})}),C&&!S&&!P&&(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-blue-600"}),a.jsx("span",{className:"text-sm text-blue-800 font-medium",children:"Tự động điền th\xf4ng tin từ hồ sơ"})]}),a.jsx("button",{onClick:A,className:"text-xs bg-blue-600 text-white px-3 py-1 rounded-full hover:bg-blue-700 transition-colors",children:"Điền tự động"})]}),a.jsx("p",{className:"text-xs text-blue-700 mt-1",children:"Nhấn để tự động điền th\xf4ng tin từ hồ sơ của bạn"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(m.fzv,{className:"inline mr-2"}),"Họ v\xe0 t\xean *"]}),a.jsx("input",{type:"text",value:s.name,onChange:e=>t({...s,name:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nhập họ v\xe0 t\xean"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(m.tUt,{className:"inline mr-2"}),"Số điện thoại *"]}),a.jsx("input",{type:"tel",value:s.phone,onChange:e=>t({...s,phone:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nhập số điện thoại"})]}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),a.jsx("input",{type:"email",value:s.email,onChange:e=>t({...s,email:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"Nhập email (t\xf9y chọn)"})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(m.TCC,{className:"inline mr-2"}),"H\xecnh thức nhận h\xe0ng"]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"pickup",checked:"pickup"===s.deliveryType,onChange:e=>t({...s,deliveryType:e.target.value}),className:"mr-2"}),a.jsx("span",{children:"Mang đi"})]}),(0,a.jsxs)("label",{className:"flex items-center",children:[a.jsx("input",{type:"radio",value:"delivery",checked:"delivery"===s.deliveryType,onChange:e=>t({...s,deliveryType:e.target.value}),className:"mr-2"}),(0,a.jsxs)("span",{children:["Giao h\xe0ng (+",i(15e3),")"]})]})]})]}),"delivery"===s.deliveryType&&(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[a.jsx(m.i63,{className:"inline mr-2"}),"Địa chỉ giao h\xe0ng *"]}),a.jsx("div",{className:"mb-3",children:(0,a.jsxs)("button",{type:"button",onClick:y,disabled:f,className:"flex items-center space-x-2 text-sm text-primary-600 hover:text-primary-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:[a.jsx(m.t$,{size:16}),a.jsx("span",{children:f?"Đang lấy vị tr\xed...":"Tự động lấy vị tr\xed hiện tại"})]})}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("input",{type:"text",value:s.address,onChange:e=>j(e.target.value),onFocus:()=>s.address.length>=3&&v(!0),onBlur:()=>setTimeout(()=>v(!1),200),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent pr-10",placeholder:"Nhập địa chỉ hoặc t\xean đường..."}),a.jsx(m.jRj,{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:16})]}),b&&a.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-60 overflow-y-auto",children:k?a.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[a.jsx("div",{className:"spinner w-4 h-4"}),a.jsx("span",{className:"text-sm",children:"Đang t\xecm kiếm..."})]})}):N.length>0?N.map(e=>(0,a.jsxs)("button",{type:"button",onClick:()=>w(e),className:"w-full px-4 py-3 text-left hover:bg-gray-50 border-b border-gray-100 last:border-b-0 flex items-center space-x-2",children:[a.jsx(m.i63,{size:16,className:"text-gray-400 flex-shrink-0"}),a.jsx("span",{className:"text-sm text-gray-700",children:e.address})]},e.id)):a.jsx("div",{className:"px-4 py-3 text-center text-gray-500",children:a.jsx("span",{className:"text-sm",children:"Kh\xf4ng t\xecm thấy địa chỉ ph\xf9 hợp"})})}),s.address&&(0,a.jsxs)("div",{className:"mt-3",children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chi tiết địa chỉ (tầng, số nh\xe0, ghi ch\xfa...)"}),a.jsx("textarea",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:2,placeholder:"V\xed dụ: Tầng 5, số nh\xe0 123, căn hộ A..."})]})]}),(0,a.jsxs)("button",{onClick:x,disabled:!s.name||!s.phone||"delivery"===s.deliveryType&&!s.address,className:"w-full btn-primary py-3 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[a.jsx("span",{children:"Tiếp tục"}),a.jsx(m.Tfp,{})]})]}),2===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-serif font-semibold text-primary-800",children:"Phương thức thanh to\xe1n"}),a.jsx("div",{className:"space-y-3",children:[{id:"cash",label:"Tiền mặt",icon:"\uD83D\uDCB5"},{id:"card",label:"Thẻ t\xedn dụng/ghi nợ",icon:"\uD83D\uDCB3"},{id:"momo",label:"V\xed MoMo",icon:"\uD83D\uDCF1"},{id:"zalopay",label:"ZaloPay",icon:"\uD83D\uDCF1"}].map(e=>(0,a.jsxs)("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[a.jsx("input",{type:"radio",name:"paymentMethod",value:e.id,checked:s.paymentMethod===e.id,onChange:e=>t({...s,paymentMethod:e.target.value}),className:"mr-3"}),a.jsx("span",{className:"mr-3",children:e.icon}),a.jsx("span",{children:e.label})]},e.id))}),(0,a.jsxs)("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ghi ch\xfa đặc biệt"}),a.jsx("textarea",{value:s.notes,onChange:e=>t({...s,notes:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",rows:3,placeholder:"Ghi ch\xfa cho đơn h\xe0ng (t\xf9y chọn)"})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:g,className:"flex-1 btn-outline py-3 flex items-center justify-center space-x-2",children:[a.jsx(m.YFh,{}),a.jsx("span",{children:"Quay lại"})]}),(0,a.jsxs)("button",{onClick:x,className:"flex-1 btn-primary py-3 flex items-center justify-center space-x-2",children:[a.jsx("span",{children:"Tiếp tục"}),a.jsx(m.Tfp,{})]})]})]}),3===p&&(0,a.jsxs)("div",{className:"space-y-4",children:[a.jsx("h3",{className:"text-lg font-serif font-semibold text-primary-800",children:"X\xe1c nhận đơn h\xe0ng"}),(0,a.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Kh\xe1ch h\xe0ng:"}),a.jsx("span",{children:s.name})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"SĐT:"}),a.jsx("span",{children:s.phone})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"H\xecnh thức:"}),a.jsx("span",{children:"pickup"===s.deliveryType?"Mang đi":"Giao h\xe0ng"})]}),"delivery"===s.deliveryType&&(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Địa chỉ:"}),a.jsx("span",{className:"text-right max-w-48 truncate",children:s.address})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[a.jsx("span",{className:"font-medium",children:"Thanh to\xe1n:"}),a.jsx("span",{children:"cash"===s.paymentMethod?"Tiền mặt":"card"===s.paymentMethod?"Thẻ":"momo"===s.paymentMethod?"MoMo":"ZaloPay"})]})]}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsxs)("button",{onClick:g,className:"flex-1 btn-outline py-3 flex items-center justify-center space-x-2",children:[a.jsx(m.YFh,{}),a.jsx("span",{children:"Quay lại"})]}),a.jsx("button",{onClick:o,disabled:h,className:"flex-1 btn-primary py-3 disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:h?(0,a.jsxs)(a.Fragment,{children:[a.jsx("div",{className:"spinner w-5 h-5"}),a.jsx("span",{children:"Đang xử l\xfd..."})]}):(0,a.jsxs)(a.Fragment,{children:[a.jsx(m.UgA,{}),a.jsx("span",{children:"Đặt m\xf3n"})]})})]})]})]})]})]}),f=()=>{let{data:e,status:s}=(0,g.useSession)(),t=(0,u.useRouter)(),{state:i,dispatch:l}=(0,p.useCart)(),[f,j]=(0,n.useState)("all"),[b,v]=(0,n.useState)(!1),[N,w]=(0,n.useState)(1),[k,C]=(0,n.useState)(!1),[T,S]=(0,n.useState)(!1),[P,A]=(0,n.useState)({name:"",phone:"",email:"",address:"",deliveryType:"pickup",paymentMethod:"cash",notes:""}),[M,D]=(0,n.useState)(null),[E,B]=(0,n.useState)(!1),{addressSuggestions:_,showAddressSuggestions:z,setShowAddressSuggestions:q,isDetectingLocation:G,isSearching:U,searchAddress:F,detectCurrentLocation:L,getPlaceDetails:I,clearSuggestions:O}=(0,x.S)(),$=async()=>{if(e?.user?.id)try{B(!0);let s=await fetch("/api/user/profile"),t=await s.json();s.ok&&t.user&&(D(t.user),A(s=>({...s,name:t.user.name||"",phone:t.user.phone||"",email:t.user.email||e.user?.email||""})))}catch(e){console.error("Error loading user profile:",e)}finally{B(!1)}};(0,n.useEffect)(()=>{e?.user?.id&&!M&&$()},[e?.user?.id]);let Q="all"===f?h.p:h.p.filter(e=>e.category===f),V=e=>{l({type:"ADD_ITEM",payload:{id:e.id,name:e.name,price:e.price,image:e.image}}),window.innerWidth<1024&&v(!0)},R=e=>{l({type:"REMOVE_ITEM",payload:e})},K=(e,s)=>{l({type:"UPDATE_QUANTITY",payload:{id:e,quantity:s}})},Y=()=>{l({type:"CLEAR_CART"})},H=async()=>{try{let e=await L();e&&A({...P,address:e})}catch(e){alert("Kh\xf4ng thể lấy vị tr\xed hiện tại. Vui l\xf2ng nhập địa chỉ thủ c\xf4ng.")}},X=e=>{A({...P,address:e}),F(e)},W=async e=>{try{let s=await I(e.placeId),t=s?.fullAddress||e.fullAddress;A({...P,address:t}),O()}catch(s){A({...P,address:e.fullAddress}),O()}},Z=e=>e.toLocaleString("vi-VN")+"đ",J=()=>{N<3&&w(N+1)},ee=()=>{N>1&&w(N-1)},es=async()=>{C(!0);try{let s={items:i.items,customerInfo:{name:P.name,phone:P.phone,email:P.email||e?.user?.email||"",address:P.address,deliveryType:P.deliveryType,paymentMethod:P.paymentMethod,notes:P.notes},isGuestOrder:!e?.user?.id},a=await fetch("/api/orders",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),n=await a.json();a.ok?(S(!0),setTimeout(()=>{Y(),A({name:"",phone:"",email:"",address:"",deliveryType:"pickup",paymentMethod:"cash",notes:""}),w(1),S(!1),v(!1),e?.user?.id?t.push("/orders"):t.push("/")},3e3)):alert(n.message||"Đ\xe3 xảy ra lỗi, vui l\xf2ng thử lại")}catch(e){console.error("Order error:",e),alert("Đ\xe3 xảy ra lỗi, vui l\xf2ng thử lại")}finally{C(!1)}};(0,n.useEffect)(()=>{let e=()=>{window.innerWidth>=1024&&v(!1)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]);let et=(()=>{let e=i.totalPrice,s=.1*e,t="delivery"===P.deliveryType?15e3:0,a=e>2e5?.05*e:0;return{subtotal:e,tax:s,deliveryFee:t,discount:a,total:e+s+t-a}})();return(0,a.jsxs)("div",{className:"min-h-screen bg-cream-50",children:[a.jsx(d.M,{children:T&&a.jsx(o.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,a.jsxs)(o.E.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.8,opacity:0},className:"bg-white rounded-xl p-8 max-w-md mx-4 text-center",children:[a.jsx("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:a.jsx(m.UgA,{className:"text-green-600 text-2xl"})}),a.jsx("h3",{className:"text-2xl font-serif font-bold text-primary-800 mb-2",children:"Đặt m\xf3n th\xe0nh c\xf4ng!"}),a.jsx("p",{className:"text-gray-600 mb-4",children:e?.user?.id?"Cảm ơn bạn đ\xe3 đặt h\xe0ng. Bạn c\xf3 thể theo d\xf5i đơn h\xe0ng trong trang đơn h\xe0ng của m\xecnh.":"Cảm ơn bạn đ\xe3 đặt h\xe0ng. Ch\xfang t\xf4i sẽ li\xean hệ với bạn trong v\xf2ng 15 ph\xfat."}),a.jsx("p",{className:"text-sm text-gray-500",children:"Trang sẽ tự động chuyển về trang chủ..."})]})})}),a.jsx("section",{className:"bg-primary-800 text-white py-12 md:py-20",children:a.jsx("div",{className:"container-custom text-center",children:(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6},children:[a.jsx("h1",{className:"text-3xl md:text-4xl lg:text-5xl font-serif font-bold mb-4 md:mb-6",children:"Đặt m\xf3n online"}),a.jsx("p",{className:"text-lg md:text-xl opacity-90 max-w-2xl mx-auto px-4",children:"Đặt m\xf3n dễ d\xe0ng v\xe0 nhận ưu đ\xe3i đặc biệt khi đặt online"})]})})}),!e&&a.jsx("section",{className:"bg-blue-50 border-b border-blue-200 py-6",children:a.jsx("div",{className:"container-custom px-4",children:(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.6},className:"bg-white rounded-xl shadow-lg p-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center space-x-3 mb-4",children:[a.jsx(m.Qyq,{className:"text-primary-600 text-2xl"}),a.jsx("h2",{className:"text-xl font-serif font-bold text-primary-800",children:"Đặt m\xf3n kh\xf4ng cần đăng k\xfd"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{children:[a.jsx("p",{className:"text-gray-600 mb-4",children:"Bạn c\xf3 thể đặt m\xf3n ngay m\xe0 kh\xf4ng cần đăng k\xfd t\xe0i khoản. Chỉ cần điền th\xf4ng tin li\xean hệ để ch\xfang t\xf4i c\xf3 thể giao h\xe0ng."}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.UgA,{className:"text-green-600"}),a.jsx("span",{children:"Đặt m\xf3n nhanh ch\xf3ng"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.UgA,{className:"text-green-600"}),a.jsx("span",{children:"Kh\xf4ng cần đăng k\xfd"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.UgA,{className:"text-green-600"}),a.jsx("span",{children:"Giao h\xe0ng tận nơi"})]})]})]}),(0,a.jsxs)("div",{className:"bg-primary-50 p-4 rounded-lg",children:[a.jsx("h3",{className:"font-medium text-primary-800 mb-3",children:"Hoặc đăng nhập để:"}),(0,a.jsxs)("div",{className:"space-y-2 text-sm text-gray-600",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-primary-600"}),a.jsx("span",{children:"Theo d\xf5i đơn h\xe0ng"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-primary-600"}),a.jsx("span",{children:"T\xedch lũy điểm thưởng"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[a.jsx(m.fzv,{className:"text-primary-600"}),a.jsx("span",{children:"Lưu địa chỉ giao h\xe0ng"})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex space-x-2",children:[a.jsx("button",{onClick:()=>t.push("/auth/signin"),className:"btn-primary text-sm px-4 py-2",children:"Đăng nhập"}),a.jsx("button",{onClick:()=>t.push("/auth/signup"),className:"btn-outline text-sm px-4 py-2",children:"Đăng k\xfd"})]})]})]})]})})}),a.jsx("div",{className:"container-custom py-4 md:py-8 px-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4 md:gap-8",children:[(0,a.jsxs)("div",{className:"lg:col-span-2",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-4 md:p-6 mb-4 md:mb-8",children:[a.jsx("h2",{className:"text-xl md:text-2xl font-serif font-bold text-primary-800 mb-4",children:"Chọn m\xf3n"}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 md:gap-3",children:[a.jsx("button",{onClick:()=>j("all"),className:`px-3 md:px-4 py-2 rounded-full font-medium transition-colors duration-200 text-sm md:text-base ${"all"===f?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Tất cả"}),h.b.map(e=>(0,a.jsxs)("button",{onClick:()=>j(e.id),className:`px-3 md:px-4 py-2 rounded-full font-medium transition-colors duration-200 text-sm md:text-base ${f===e.id?"bg-primary-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:[e.icon," ",e.name]},e.id))]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 md:gap-6",children:Q.map((e,s)=>(0,a.jsxs)(o.E.div,{initial:{opacity:0,y:30},animate:{opacity:1,y:0},transition:{duration:.6,delay:.1*s},className:"bg-white rounded-xl shadow-lg overflow-hidden hover:shadow-xl transition-shadow duration-300 flex flex-col",children:[(0,a.jsxs)(c(),{href:`/product/${e.id}`,className:"block",children:[a.jsx("div",{className:"relative h-40 md:h-48",children:a.jsx(r(),{src:e.image,alt:e.name,fill:!0,className:"object-cover"})}),(0,a.jsxs)("div",{className:"p-4 md:p-6 flex flex-col flex-grow",children:[a.jsx("h3",{className:"text-lg md:text-xl font-serif font-semibold text-primary-800 mb-2",children:e.name}),a.jsx("p",{className:"text-sm md:text-base text-gray-600 mb-4 leading-relaxed flex-grow",children:e.description})]})]}),a.jsx("div",{className:"p-4 md:p-6 pt-0",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[a.jsx("span",{className:"text-lg md:text-2xl font-bold text-primary-600",children:Z(e.price)}),(0,a.jsxs)("button",{onClick:()=>V(e),className:"btn-primary flex items-center space-x-2 text-sm md:text-base px-3 md:px-4 py-2 md:py-3",children:[a.jsx(m.OvN,{}),a.jsx("span",{children:"Th\xeam"})]})]})})]},e.id))})]}),a.jsx("div",{className:"hidden lg:block lg:col-span-1",children:a.jsx(y,{cart:i.items,customerInfo:P,setCustomerInfo:A,orderSummary:et,formatPrice:Z,updateQuantity:K,removeFromCart:R,clearCart:Y,handleSubmitOrder:es,isSubmitting:k,currentStep:N,nextStep:J,prevStep:ee,handleDetectLocation:H,isDetectingLocation:G,handleAddressChange:X,showAddressSuggestions:z,setShowAddressSuggestions:q,addressSuggestions:_,selectAddress:W,isSearching:U,session:e,router:t,userProfile:M,isLoadingProfile:E,loadUserProfile:$})})]})}),a.jsx(d.M,{children:b&&a.jsx(o.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"lg:hidden fixed inset-0 z-50 bg-black bg-opacity-50",onClick:()=>v(!1),children:a.jsx(o.E.div,{initial:{y:"100%"},animate:{y:0},exit:{y:"100%"},className:"absolute bottom-0 left-0 right-0 bg-white rounded-t-xl max-h-[85vh] overflow-y-auto",onClick:e=>e.stopPropagation(),children:(0,a.jsxs)("div",{className:"flex flex-col h-full",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-200 flex-shrink-0",children:[(0,a.jsxs)("h2",{className:"text-xl font-serif font-bold text-primary-800",children:["Giỏ h\xe0ng (",i.totalItems,")"]}),a.jsx("button",{onClick:()=>v(!1),className:"p-2 hover:bg-gray-100 rounded-full",children:a.jsx(m.q5L,{size:20})})]}),a.jsx("div",{className:"flex-1 overflow-y-auto",children:a.jsx("div",{className:"p-4",children:a.jsx(y,{cart:i.items,customerInfo:P,setCustomerInfo:A,orderSummary:et,formatPrice:Z,updateQuantity:K,removeFromCart:R,clearCart:Y,handleSubmitOrder:es,isSubmitting:k,currentStep:N,nextStep:J,prevStep:ee,isMobile:!0,handleDetectLocation:H,isDetectingLocation:G,handleAddressChange:X,showAddressSuggestions:z,setShowAddressSuggestions:q,addressSuggestions:_,selectAddress:W,isSearching:U,session:e,router:t,userProfile:M,isLoadingProfile:E,loadUserProfile:$})})})]})})})})]})}},96736:(e,s,t)=>{"use strict";t.d(s,{b:()=>n,p:()=>a});let a=[{id:"1",name:"C\xe0 ph\xea đen truyền thống",description:"C\xe0 ph\xea đen nguy\xean chất, pha theo phương ph\xe1p truyền thống Việt Nam",price:25e3,image:"https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400",category:"coffee",isPopular:!0},{id:"2",name:"C\xe0 ph\xea sữa đ\xe1",description:"C\xe0 ph\xea pha với sữa đặc, th\xeam đ\xe1 vi\xean m\xe1t lạnh",price:3e4,image:"https://images.unsplash.com/photo-1509042239860-f550ce710b93?w=400",category:"coffee",isPopular:!0},{id:"3",name:"Cappuccino",description:"C\xe0 ph\xea espresso với sữa tươi v\xe0 lớp foam mịn m\xe0ng",price:45e3,image:"https://images.unsplash.com/photo-1572442388796-11668a67e53d?w=400",category:"coffee"},{id:"4",name:"Latte",description:"C\xe0 ph\xea espresso với nhiều sữa tươi v\xe0 lớp foam nghệ thuật",price:5e4,image:"https://images.unsplash.com/photo-1561047029-3000c68339ca?w=400",category:"coffee"},{id:"5",name:"Americano",description:"C\xe0 ph\xea espresso pha lo\xe3ng với nước n\xf3ng",price:4e4,image:"https://images.unsplash.com/photo-1510591509098-f4fdc6d0ff04?w=400",category:"coffee"},{id:"6",name:"Mocha",description:"C\xe0 ph\xea espresso với s\xf4 c\xf4 la v\xe0 sữa tươi",price:55e3,image:"https://images.unsplash.com/photo-1511920170033-f8396924c348?w=400",category:"coffee"},{id:"7",name:"Tr\xe0 đen Earl Grey",description:"Tr\xe0 đen hảo hạng với hương bergamot tinh tế",price:35e3,image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400",category:"tea",isPopular:!0},{id:"8",name:"Tr\xe0 xanh Matcha",description:"Tr\xe0 xanh Nhật Bản nguy\xean chất, bột matcha cao cấp",price:4e4,image:"https://images.unsplash.com/photo-1515823064-d6e0c04616a7?w=400",category:"tea"},{id:"9",name:"Tr\xe0 hoa c\xfac",description:"Tr\xe0 hoa c\xfac thơm ngon, tốt cho sức khỏe",price:3e4,image:"https://images.unsplash.com/photo-1571934811356-5cc061b6821f?w=400",category:"tea"},{id:"10",name:"Tr\xe0 sữa tr\xe2n ch\xe2u",description:"Tr\xe0 sữa đậm đ\xe0 với tr\xe2n ch\xe2u dai gi\xf2n",price:45e3,image:"https://images.unsplash.com/photo-1525385133512-2f3bdd039054?w=400",category:"tea",isPopular:!0},{id:"11",name:"Tr\xe0 đ\xe0o cam sả",description:"Tr\xe0 đ\xe0o tươi m\xe1t với cam sả thơm lừng",price:4e4,image:"https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400",category:"tea"},{id:"12",name:"Tr\xe0 sữa matcha",description:"Tr\xe0 sữa matcha ngọt ng\xe0o với lớp kem mịn",price:5e4,image:"https://images.unsplash.com/photo-1515823064-d6e0c04616a7?w=400",category:"tea"},{id:"13",name:"B\xe1nh croissant",description:"B\xe1nh sừng b\xf2 Ph\xe1p gi\xf2n tan, thơm bơ",price:25e3,image:"https://images.unsplash.com/photo-1555507036-ab1f4038808a?w=400",category:"pastry",isPopular:!0},{id:"14",name:"B\xe1nh muffin chocolate",description:"B\xe1nh muffin chocolate đậm đ\xe0, mềm mịn",price:3e4,image:"https://images.unsplash.com/photo-1607958996333-41aef7caefaa?w=400",category:"pastry"},{id:"15",name:"B\xe1nh tiramisu",description:"B\xe1nh tiramisu \xdd truyền thống, ngọt ng\xe0o",price:45e3,image:"https://images.unsplash.com/photo-1571877227200-a0d98ea607e9?w=400",category:"pastry"},{id:"16",name:"B\xe1nh cheesecake",description:"B\xe1nh cheesecake New York, kem ph\xf4 mai mịn m\xe0ng",price:5e4,image:"https://images.unsplash.com/photo-1533134242443-d4fd215305ad?w=400",category:"pastry"},{id:"17",name:"B\xe1nh donut",description:"B\xe1nh donut mềm mịn với nhiều vị kh\xe1c nhau",price:2e4,image:"https://images.unsplash.com/photo-1551024506-0bccd828d307?w=400",category:"pastry"},{id:"18",name:"B\xe1nh macaron",description:"B\xe1nh macaron Ph\xe1p nhiều m\xe0u sắc, ngọt ng\xe0o",price:35e3,image:"https://images.unsplash.com/photo-1558961363-fa8fdf82db35?w=400",category:"pastry"},{id:"19",name:"C\xe0 ph\xea kem trứng",description:"C\xe0 ph\xea đặc biệt với kem trứng mịn m\xe0ng",price:55e3,image:"https://images.unsplash.com/photo-1495474472287-4d71bcdd2085?w=400",category:"special",isPopular:!0},{id:"20",name:"Tr\xe0 sữa kem cheese",description:"Tr\xe0 sữa với lớp kem cheese đậm đ\xe0",price:5e4,image:"https://images.unsplash.com/photo-1525385133512-2f3bdd039054?w=400",category:"special"},{id:"21",name:"Smoothie tr\xe1i c\xe2y",description:"Sinh tố tr\xe1i c\xe2y tươi m\xe1t, nhiều vitamin",price:45e3,image:"https://images.unsplash.com/photo-1553530666-ba11a7da3888?w=400",category:"special"},{id:"22",name:"Frapp\xe9 chocolate",description:"Đồ uống lạnh chocolate đậm đ\xe0",price:5e4,image:"https://images.unsplash.com/photo-1511920170033-f8396924c348?w=400",category:"special"}],n=[{id:"coffee",name:"C\xe0 ph\xea",icon:"☕"},{id:"tea",name:"Tr\xe0",icon:"\uD83C\uDF75"},{id:"pastry",name:"B\xe1nh ngọt",icon:"\uD83E\uDD50"},{id:"special",name:"Đặc biệt",icon:"⭐"}]},30053:(e,s,t)=>{"use strict";t.r(s),t.d(s,{$$typeof:()=>i,__esModule:()=>n,default:()=>r});let a=(0,t(86843).createProxy)(String.raw`/Users/tuannguyen/Applications/Mbread/app/ordering/page.tsx`),{__esModule:n,$$typeof:i}=a,r=a.default}};var s=require("../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),a=s.X(0,[638,579,508],()=>t(85833));module.exports=a})();